from transformers import AutoTokenizer

def get_qwen3_tokenizer():
    tokenizer = AutoTokenizer.from_pretrained("Qwen/Qwen3-1.7B")
    return tokenizer

if __name__ == "__main__":

    info = """
    (async_llm_server_3 MultiTurnAsyncvLLMEngine pid=16408, ip=10.124.174.97) Env Result: {'reward_tensor': tensor([0., 0., 0.,  ..., 0., 0., 0.]), 'reward_extra_info': defaultdict(<class 'list'>, {'correctness': [False], 'performance': [0.0], 'is_speedup_positive': [False], 'is_decoy_kernel': [None], 'compilation': [True], 'success': [False], 'status': ['completed'], 'error': [''], 'correctness_tensor': tensor([0.]), 'performance_tensor': tensor([0.]), 'compilation_tensor': tensor([1.])}), 'env_state': {'task_id': 'parallel_task_000007_63dd6026', 'status': 'completed', 'compiled': True, 'correctness': False, 'decoy_kernel': None, 'reference_runtime': 0.0, 'kernel_runtime': -1.0, 'speedup': 0.0, 'metadata': {'hardware': 'NVIDIA H100 80GB HBM3', 'device': 'cuda:4', 'runtime_error': 'Traceback (most recent call last):\n  File "/opt/tiger/account/kernelbench/src/eval.py", line 1788, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp3q9q_8mm.py", line 149, in forward\n  File "/usr/local/lib/python3.10/dist-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/usr/local/lib/python3.10/dist-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/usr/local/lib/python3.10/dist-packages/triton/compiler/compiler.py", line 281, in compile\n    key = f"{triton_key()}-{src.hash()}-{backend.hash()}-{options.hash()}-{str(sorted(env_vars.items()))}"\n  File "/usr/local/lib/python3.10/dist-packages/triton/compiler/compiler.py", line 78, in hash\n    key = f"{self.fn.cache_key}-{str(self.attrs)}-{sorted_sig}-{constants_key}"\n  File "/usr/local/lib/python3.10/dist-packages/triton/runtime/jit.py", line 696, in cache_key\n    dependencies_finder.visit(self.parse())\n  File "/usr/lib/python3.10/ast.py", line 418, in visit\n    return visitor(node)\n  File "/usr/lib/python3.10/ast.py", line 426, in generic_visit\n    self.visit(item)\n  File "/usr/lib/python3.10/ast.py", line 418, in visit\n    return visitor(node)\n  File "/usr/local/lib/python3.10/dist-packages/triton/runtime/jit.py", line 163, in visit_FunctionDef\n    self.generic_visit(node)\n  File "/usr/lib/python3.10/ast.py", line 426, in generic_visit\n    self.visit(item)\n  File "/usr/lib/python3.10/ast.py", line 418, in visit\n    return visitor(node)\n  File "/usr/local/lib/python3.10/dist-packages/triton/runtime/jit.py", line 229, in visit_For\n    self.generic_visit(node)\n  File "/usr/lib/python3.10/ast.py", line 426, in generic_visit\n    self.visit(item)\n  File "/usr/lib/python3.10/ast.py", line 418, in visit\n    return visitor(node)\n  File "/usr/local/lib/python3.10/dist-packages/triton/runtime/jit.py", line 229, in visit_For\n    self.generic_visit(node)\n  File "/usr/lib/python3.10/ast.py", line 426, in generic_visit\n    self.visit(item)\n  File "/usr/lib/python3.10/ast.py", line 418, in visit\n    return visitor(node)\n  File "/usr/local/lib/python3.10/dist-packages/triton/runtime/jit.py", line 217, in visit_Assign\n    self.generic_visit(node)\n  File "/usr/lib/python3.10/ast.py", line 428, in generic_visit\n    self.visit(value)\n  File "/usr/lib/python3.10/ast.py", line 418, in visit\n    return visitor(node)\n  File "/usr/lib/python3.10/ast.py", line 428, in generic_visit\n    self.visit(value)\n  File "/usr/lib/python3.10/ast.py", line 418, in visit\n    return visitor(node)\n  File "/usr/local/lib/python3.10/dist-packages/triton/runtime/jit.py", line 151, in visit_Attribute\n    lhs = self.visit(node.value)\n  File "/usr/lib/python3.10/ast.py", line 418, in visit\n    return visitor(node)\n  File "/usr/local/lib/python3.10/dist-packages/triton/runtime/jit.py", line 156, in visit_Attribute\n    ret = getattr(lhs, node.attr)\nAttributeError: module \'triton.language\' has no attribute \'libdevice\'\n', 'runtime_error_name': 'builtins.AttributeError', 'gpu_name': 'NVIDIA H100 80GB HBM3', 'backend': 'triton', 'num_correct_trials': 5, 'num_perf_trials': 100, 'ref_skipped': True}, 'error_message': 'Kernel incorrect; reference timing skipped', 'error_code': None, 'submitted_at': None, 'completed_at': None, 'processing_time': None, 'reward': 0.0, 'success': False, 'score': 0.0, 'profiling': None}}
    """
    tokenizer = get_qwen3_tokenizer()

    print(len(tokenizer.encode(info)))